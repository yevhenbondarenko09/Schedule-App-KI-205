<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–†–æ–∑–∫–ª–∞–¥ –ö–Ü-205</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #2E365A;
            --secondary-color: #6C5E82;
            --accent-pink: #E0797F;
            --soft-blue: #96A4C5;
            --card-bg: #3B446B;
            --text-main: #FFFFFF;
            --text-muted: #B0BCD5;
            --success: #6CAE82;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

         /* --- Header --- */
        header {
            background-color: var(--bg-color);
            
            /* –ó–ú–Ü–ù–ï–ù–û: –î–æ–¥–∞–Ω–æ –±—ñ–ª—å—à–µ –≤—ñ–¥—Å—Ç—É–ø—É –∑–≤–µ—Ä—Ö—É (45px) + –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ "—á—É–±—á–∏–∫–∞" iPhone */
            padding: 45px 20px 15px 20px; 
            padding-top: max(45px, env(safe-area-inset-top));

            z-index: 100;
            flex-shrink: 0;
            border-bottom: 1px solid rgba(150, 164, 197, 0.1);
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .current-time {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .date-info {
            font-size: 0.85rem;
            color: var(--soft-blue);
            text-align: right;
        }

        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .toggle-container {
            background: rgba(0,0,0,0.25);
            border-radius: 50px;
            padding: 4px;
            display: flex;
        }

        .toggle-btn {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--soft-blue);
            padding: 8px 0;
            font-size: 0.75rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .toggle-btn.active {
            background-color: var(--secondary-color);
            color: white;
        }

        .toggle-btn.subgroup-active {
            background-color: var(--accent-pink);
            color: white;
        }

        /* --- Main Carousel Container --- */
        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        #schedule-carousel {
            flex: 1;
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        #schedule-carousel::-webkit-scrollbar { display: none; }

        /* --- Slide (Day) Styles --- */
        .day-slide {
            flex: 0 0 100%;
            width: 100%;
            scroll-snap-align: start;
            overflow-y: auto;
            padding: 20px;
            padding-bottom: 60px;
        }

        .day-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 5px solid var(--soft-blue);
        }

        .day-header h2 {
            font-size: 1.8rem;
            font-weight: 800;
            margin-right: 12px;
            letter-spacing: -0.5px;
        }

        .day-header.is-today h2 { color: var(--accent-pink); }
        .day-header.is-today { border-left-color: var(--accent-pink); }

        .label-today {
            font-size: 0.75rem;
            background: var(--accent-pink);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 700;
            text-transform: uppercase;
        }

        /* --- Lesson Card Styles --- */
        .lesson-card {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid rgba(150, 164, 197, 0.1);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .lesson-header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }

        /* NEW STYLE: Lesson Number Badge */
        .lesson-number {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--soft-blue);
            min-width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            flex-shrink: 0;
            border: 1px solid rgba(150, 164, 197, 0.3);
        }

        .lesson-subject {
            font-size: 1.1rem;
            font-weight: 700;
            line-height: 1.4;
            color: var(--text-main);
            flex: 1;
            white-space: normal; 
            word-wrap: break-word;
        }

        .lesson-time {
            flex-shrink: 0;
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--soft-blue);
            background: rgba(0,0,0,0.25);
            padding: 8px 12px;
            border-radius: 12px;
            white-space: nowrap;
        }

        .tags {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
            flex-wrap: wrap;
            padding-left: 36px; /* Indent tags to align with text, considering badge width */
        }

        .tag {
            font-size: 0.7rem;
            padding: 4px 10px;
            border-radius: 8px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .tag.lecture { background-color: rgba(108, 94, 130, 0.3); color: #C4B5D6; border: 1px solid var(--secondary-color); }
        .tag.lab { background-color: rgba(224, 121, 127, 0.2); color: var(--accent-pink); border: 1px solid var(--accent-pink); }
        .tag.practical { background-color: rgba(108, 174, 130, 0.2); color: var(--success); border: 1px solid var(--success); }
        .tag.room { background: rgba(150, 164, 197, 0.15); border: 1px solid var(--soft-blue); color: var(--soft-blue); }
        .tag.remote { background: rgba(55, 122, 35, 0.437); border: 1px solid var(--accent-blue);  color: var(--text-main);  }
        .lesson-details {
            display: flex;
            flex-direction: column;
            gap: 6px;
            font-size: 0.9rem;
            color: var(--text-muted);
            border-top: 1px solid rgba(255,255,255,0.05);
            padding-top: 10px;
            padding-left: 36px; /* Indent details as well */
        }

        .free-window {
            border: 2px dashed rgba(150, 164, 197, 0.3);
            display: flex; 
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 20px;
            color: var(--text-muted);
            font-style: italic;
        }

        /* --- Indicators --- */
        .carousel-indicators {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 8px;
            z-index: 50;
            pointer-events: none;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: rgba(255,255,255,0.2);
            transition: all 0.3s ease;
            pointer-events: auto;
            cursor: pointer;
        }

        .dot.active {
            background-color: var(--accent-pink);
            transform: scale(1.3);
        }

        .empty-day-msg {
            text-align: center;
            margin-top: 50px;
            color: var(--soft-blue);
            font-size: 1.1rem;
            opacity: 0.7;
        }
    </style>
</head>
<body>

    <header>
        <!-- –°–ø–æ—á–∞—Ç–∫—É –∫–Ω–æ–ø–∫–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—è -->
        <div class="controls-grid">
            <div class="toggle-container">
                <button class="toggle-btn" id="btn-numerator" onclick="setWeekType('numerator')">–ß–∏—Å–µ–ª—å–Ω–∏–∫</button>
                <button class="toggle-btn" id="btn-denominator" onclick="setWeekType('denominator')">–ó–Ω–∞–º–µ–Ω–Ω–∏–∫</button>
            </div>
            <div class="toggle-container">
                <button class="toggle-btn" id="btn-sub1" onclick="setSubgroup(1)">–ü—ñ–¥–≥—Ä—É–ø–∞ 1</button>
                <button class="toggle-btn" id="btn-sub2" onclick="setSubgroup(2)">–ü—ñ–¥–≥—Ä—É–ø–∞ 2</button>
            </div>
        </div>

        <!-- –ü–æ—Ç—ñ–º —á–∞—Å —ñ –¥–∞—Ç–∞ (–¥–æ–¥–∞–Ω–æ margin-top –¥–ª—è –≤—ñ–¥—Å—Ç—É–ø—É –≤—ñ–¥ –∫–Ω–æ–ø–æ–∫) -->
        <div class="top-bar" style="margin-bottom: 0; margin-top: 15px;">
            <div class="current-time" id="clock">00:00</div>
            <div class="date-info">
                <div id="current-date">...</div>
                <div style="font-weight:700; color: var(--accent-pink); margin-top: 2px;" id="week-indicator">...</div>
            </div>
        </div>
    </header>

    <main>
        <div id="schedule-carousel"></div>
        <div class="carousel-indicators" id="dots-container"></div>
    </main>

    <script>
        const SEMESTER_START = new Date("2026-02-09T00:00:00"); 
        
        const scheduleData = [
          {
            day: "–ü–æ–Ω–µ–¥—ñ–ª–æ–∫",
            lessons: [
              { id: 1, time: "08:30 - 09:50", items: [ { subject: "–ê–ª–≥–æ—Ä–∏—Ç–º–∏ —Ç–∞ –º–æ–¥–µ–ª—ñ –æ–±—á–∏—Å–ª–µ–Ω—å", type: "Lab", teacher: "–°—î—á–∫–æ –û.–Ü.", room: "905 V –Ω.–∫.", subgroup: 1, week: "both" }, { subject: "–ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º", type: "Lab", teacher: "–ë—É–¥–∑ –Ü.–°.", room: "907 V –Ω.–∫.", subgroup: 2, week: "both" } ] },
              { id: 2, time: "10:05 - 11:25", items: [ { subject: "–ê–ª–≥–æ—Ä–∏—Ç–º–∏ —Ç–∞ –º–æ–¥–µ–ª—ñ –æ–±—á–∏—Å–ª–µ–Ω—å", type: "Lab", teacher: "–°—î—á–∫–æ –û.–Ü.", room: "905 V –Ω.–∫.", subgroup: 2, week: "both" } ] },
              { id: 3, time: "11:40 - 13:00", items: [ { subject: "–§—ñ–ª–æ—Å–æ—Ñ—ñ—è", type: "Lecture", teacher: "–ß—É—Ä—Å—ñ–Ω–æ–≤–∞ –û.–Æ.", room: "411 I –Ω.–∫.", subgroup: "both", week: "both" } ] },
              { id: 4, time: "13:15 - 14:35", items: [ { subject: "–ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º", type: "Lab", teacher: "–ë—É–¥–∑ –Ü.–°.", room: "907 V –Ω.–∫.", subgroup: 1, week: "both" } ] }
            ]
          },
          {
            day: "–í—ñ–≤—Ç–æ—Ä–æ–∫",
            lessons: [
              { id: 1, time: "08:30 - 09:50", items: [ { subject: "–°–∏—Å—Ç–µ–º–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —á–∞—Å—Ç–∏–Ω–∞ 1", type: "Lecture", teacher: "–ü—É–π–¥–∞ –î.–í.", room: "512 V –Ω.–∫.", subgroup: "both", week: "both" } ] },
              { id: 2, time: "10:05 - 11:25", items: [ { subject: "–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –±–∞–∑ –¥–∞–Ω–∏—Ö", type: "Lecture", teacher: "–ö–æ–ª–æ–¥—á–∞–∫ –û.–ú.", room: "906 V –Ω.–∫.", subgroup: "both", week: "both", remote:true } ] },
              { id: 3, time: "11:40 - 13:00", items: [ { subject: "–§—ñ–ª–æ—Å–æ—Ñ—ñ—è", type: "Practical", teacher: "–ü–∞–Ω—å–∫–æ –û.–Ü.", room: "902 V –Ω.–∫.", subgroup: "both", week: "numerator" } ] }
            ]
          },
          {
            day: "–°–µ—Ä–µ–¥–∞",
            lessons: [
              { id: 1, time: "08:30 - 09:50", items: [ { subject: "–ú–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è –∫–æ–º–ø'—é—Ç–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º", type: "Lecture", teacher: "–ë—É–¥–∑ –Ü.–°.", room: "906 V –Ω.–∫.", subgroup: "both", week: "both" } ] },
              { id: 2, time: "10:05 - 11:25", items: [ { subject: "–°–∏—Å—Ç–µ–º–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —á–∞—Å—Ç–∏–Ω–∞ 1", type: "Lab", teacher: "–ú–∞–∫—Å–∏–º—ñ–≤ –ú.–†.", room: "505a2 V –Ω.–∫.", subgroup: 1, week: "numerator", remote:true }, { subject: "–°–∏—Å—Ç–µ–º–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —á–∞—Å—Ç–∏–Ω–∞ 1", type: "Lab", teacher: "–ú–∞–∫—Å–∏–º—ñ–≤ –ú.–†.", room: "505a2 V –Ω.–∫.", subgroup: 2, week: "denominator", remote:true } ] }
            ]
          },
          {
            day: "–ß–µ—Ç–≤–µ—Ä",
            lessons: [
              { id: 1, time: "08:30 - 09:50", items: [ { subject: "–ê–ª–≥–æ—Ä–∏—Ç–º–∏ —Ç–∞ –º–æ–¥–µ–ª—ñ –æ–±—á–∏—Å–ª–µ–Ω—å", type: "Lecture", teacher: "–ö–æ–ª–æ–¥—ñ–π –ó.–û.", room: "906 V –Ω.–∫.", subgroup: "both", week: "both" } ] },
              { id: 2, time: "10:05 - 11:25", items: [ { subject: "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω–∞ —Å—Ö–µ–º–æ—Ç–µ—Ö–Ω—ñ–∫–∞", type: "Lab", teacher: "–ß–µ—Ä—á–∏–∫ –ì.–¢.", room: "509 V –Ω.–∫.", subgroup: 1, week: "both" }, { subject: "–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –±–∞–∑ –¥–∞–Ω–∏—Ö", type: "Lab", teacher: "–Ü–≤–∞–Ω–æ–≤ –Æ.–°.", room: "505a2 V –Ω.–∫.", subgroup: 2, week: "both" } ] },
              { id: 3, time: "11:40 - 13:00", items: [ { subject: "–û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –±–∞–∑ –¥–∞–Ω–∏—Ö", type: "Lab", teacher: "–Ü–≤–∞–Ω–æ–≤ –Æ.–°.", room: "505a2 V –Ω.–∫.", subgroup: 1, week: "both" }, { subject: "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω–∞ —Å—Ö–µ–º–æ—Ç–µ—Ö–Ω—ñ–∫–∞", type: "Lab", teacher: "–ß–µ—Ä—á–∏–∫ –ì.–¢.", room: "509 V –Ω.–∫.", subgroup: 2, week: "both" } ] }
            ]
          },
          {
            day: "–ü'—è—Ç–Ω–∏—Ü—è",
            lessons: [
              { id: 2, time: "10:05 - 11:25", items: [ { subject: "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω–∞ —Å—Ö–µ–º–æ—Ç–µ—Ö–Ω—ñ–∫–∞", type: "Practical", teacher: "–ß–µ—Ä—á–∏–∫ –ì.–¢.", room: "902 V –Ω.–∫.", subgroup: "both", week: "numerator" }, { subject: "–°–∏—Å—Ç–µ–º–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è, —á–∞—Å—Ç–∏–Ω–∞ 1", type: "Practical", teacher: "–ú–∞–∫—Å–∏–º—ñ–≤ –ú.–†.", room: "902 V –Ω.–∫.", subgroup: "both", week: "denominator", remote:true } ] },
              { id: 3, time: "11:40 - 13:00", items: [ { subject: "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω–∞ —Å—Ö–µ–º–æ—Ç–µ—Ö–Ω—ñ–∫–∞", type: "Lecture", teacher: "–ü–∞—Ä–∞–ª—é—Ö –Ü.–ü., –ö–ª—É—à–∏–Ω –Æ.–°.", room: "512 V –Ω.–∫.", subgroup: "both", week: "both" } ] }
            ]
          }
        ];

        const state = { weekType: 'numerator', subgroup: 1, activeIndex: 0 };
        let observer;

        function init() {
            state.weekType = calculateWeekType();
            const savedSubgroup = localStorage.getItem('ki205_subgroup');
            if (savedSubgroup) state.subgroup = parseInt(savedSubgroup);

            // –õ–û–ì–Ü–ö–ê –°–¢–ê–†–¢–£: –í–∏–∑–Ω–∞—á–∞—î–º–æ –¥–µ–Ω—å –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É
            const dayOfWeek = new Date().getDay(); // 0=–ù–¥, 1=–ü–Ω...
            // –Ø–∫—â–æ –≤–∏—Ö—ñ–¥–Ω—ñ -> –ø–æ–Ω–µ–¥—ñ–ª–æ–∫ (0), —ñ–Ω–∞–∫—à–µ –¥–µ–Ω—å - 1
            let startIndex = (dayOfWeek === 0 || dayOfWeek === 6) ? 0 : dayOfWeek - 1;
            // –°—Ç—Ä–∞—Ö–æ–≤–∫–∞ –≤—ñ–¥ –ø–æ–º–∏–ª–æ–∫ (—â–æ–± –±—É–ª–æ –≤ –º–µ–∂–∞—Ö 0-4)
            if (startIndex < 0) startIndex = 0;
            if (startIndex > 4) startIndex = 4;
            
            state.activeIndex = startIndex;

            updateTime();
            setInterval(updateTime, 1000);
            updateUI();
        }

        function calculateWeekType() {
            const now = new Date();
            const start = new Date(SEMESTER_START);
            start.setHours(0,0,0,0);
            const current = new Date(now);
            current.setHours(0,0,0,0);
            const diffTime = current - start;
            if(diffTime < 0) return 'numerator'; 
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            const weekNumber = Math.floor(diffDays / 7);
            return (weekNumber % 2 === 0) ? 'numerator' : 'denominator';
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('uk-UA', { hour: '2-digit', minute: '2-digit' });
            const options = { weekday: 'long', month: 'long', day: 'numeric' };
            const dateString = now.toLocaleDateString('uk-UA', options);
            document.getElementById('current-date').innerText = dateString.charAt(0).toUpperCase() + dateString.slice(1);
        }

        function setSubgroup(val) {
            state.subgroup = val;
            localStorage.setItem('ki205_subgroup', val);
            updateUI();
        }

        function setWeekType(val) {
            state.weekType = val;
            updateUI();
        }

        function getDayIndex(dayName) {
            const map = { "–ü–æ–Ω–µ–¥—ñ–ª–æ–∫": 1, "–í—ñ–≤—Ç–æ—Ä–æ–∫": 2, "–°–µ—Ä–µ–¥–∞": 3, "–ß–µ—Ç–≤–µ—Ä": 4, "–ü'—è—Ç–Ω–∏—Ü—è": 5 };
            return map[dayName] || 0;
        }

        function updateUI() {
            document.getElementById('btn-numerator').className = `toggle-btn ${state.weekType === 'numerator' ? 'active' : ''}`;
            document.getElementById('btn-denominator').className = `toggle-btn ${state.weekType === 'denominator' ? 'active' : ''}`;
            document.getElementById('btn-sub1').className = `toggle-btn ${state.subgroup === 1 ? 'subgroup-active' : ''}`;
            document.getElementById('btn-sub2').className = `toggle-btn ${state.subgroup === 2 ? 'subgroup-active' : ''}`;
            document.getElementById('week-indicator').innerText = state.weekType === 'numerator' ? '–ß–∏—Å–µ–ª—å–Ω–∏–∫' : '–ó–Ω–∞–º–µ–Ω–Ω–∏–∫';
            renderSchedule();
        }

        function renderSchedule() {
            const carousel = document.getElementById('schedule-carousel');
            const dotsContainer = document.getElementById('dots-container');
            
            carousel.innerHTML = '';
            dotsContainer.innerHTML = '';

            const currentDayIndex = new Date().getDay(); 
            let targetSlide = null;

            scheduleData.forEach((dayData, index) => {
                const dayIndex = getDayIndex(dayData.day);
                const isToday = dayIndex === currentDayIndex;

                const slide = document.createElement('div');
                slide.className = 'day-slide';
                slide.id = `slide-${index}`;
                
                const headerHtml = `
                    <div class="day-header ${isToday ? 'is-today' : ''}">
                        <h2>${dayData.day}</h2>
                        ${isToday ? '<span class="label-today">–°—å–æ–≥–æ–¥–Ω—ñ</span>' : ''}
                    </div>
                `;
                slide.innerHTML = headerHtml;

                let hasContent = false;
                
                dayData.lessons.forEach(lessonSlot => {
                    const myLesson = lessonSlot.items.find(item => 
                        (item.week === 'both' || item.week === state.weekType) && 
                        (item.subgroup === 'both' || item.subgroup === state.subgroup)
                    );
                    
                    const anyLessonAtAll = lessonSlot.items.length > 0;

                    if (myLesson) {
                        hasContent = true;
                        slide.innerHTML += createLessonCard(myLesson, lessonSlot.time, lessonSlot.id);
                    } else if (anyLessonAtAll) {
                        const otherLesson = lessonSlot.items.find(item => 
                           (item.week === 'both' || item.week === state.weekType) && 
                           (item.subgroup !== 'both' && item.subgroup !== state.subgroup)
                        );
                        if(otherLesson) {
                             hasContent = true;
                             slide.innerHTML += `
                                <div class="lesson-card free-window">
                                    <div class="lesson-number">${lessonSlot.id}</div>
                                    <span>–í—ñ–∫–Ω–æ (${lessonSlot.time})</span>
                                </div>
                             `;
                        }
                    }
                });

                if(!hasContent) {
                    slide.innerHTML += '<div class="empty-day-msg">–ü–∞—Ä –Ω–µ–º–∞—î üéâ</div>';
                }

                carousel.appendChild(slide);

                const dot = document.createElement('div');
                dot.className = 'dot';
                
                // –û–ù–û–í–õ–ï–ù–û: –ü—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ —Ç–æ—á–∫—É —Ç–µ–∂ –æ–Ω–æ–≤–ª—é—î–º–æ state
                dot.onclick = () => { 
                    state.activeIndex = index;
                    slide.scrollIntoView({ behavior: 'smooth', inline: 'start' }); 
                };
                dotsContainer.appendChild(dot);

                // –û–ù–û–í–õ–ï–ù–û: –®—É–∫–∞—î–º–æ —Å–ª–∞–π–¥ –Ω–µ –ø–æ isToday, –∞ –ø–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ–º—É activeIndex
                if(index === state.activeIndex) targetSlide = slide;
            });

            setupObserver();
            
            // –û–ù–û–í–õ–ï–ù–û: –ú–∏—Ç—Ç—î–≤–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –¥–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ–≥–æ —Å–ª–∞–π–¥—É (–±–µ–∑ –∞–Ω—ñ–º–∞—Ü—ñ—ó, —â–æ–± –Ω–µ –¥—Ä–∞—Ç—É–≤–∞–ª–æ)
            if(targetSlide) {
                targetSlide.scrollIntoView({ behavior: 'auto', inline: 'start' });
            }
        }

        function setupObserver() {
            if(observer) observer.disconnect();
            const options = { root: document.getElementById('schedule-carousel'), threshold: 0.6 };
            
            observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const index = parseInt(entry.target.id.split('-')[1]);
                        
                        // –û–ù–û–í–õ–ï–ù–û: –ó–∞–ø–∞–º'—è—Ç–æ–≤—É—î–º–æ, –¥–µ –º–∏ –∑–∞—Ä–∞–∑
                        state.activeIndex = index;
                        
                        updateDots(index);
                    }
                });
            }, options);
            document.querySelectorAll('.day-slide').forEach(slide => observer.observe(slide));
        }

        function updateDots(activeIndex) {
            document.querySelectorAll('.dot').forEach((dot, idx) => {
                if(idx == activeIndex) dot.classList.add('active');
                else dot.classList.remove('active');
            });
        }

        // UPDATED: Added ID parameter
      function createLessonCard(item, time, id) {
            let typeClass = '';
            if(item.type.includes('Lab')) typeClass = 'lab';
            else if(item.type.includes('Lecture')) typeClass = 'lecture';
            else typeClass = 'practical';

            let typeLabel = item.type;
            if(typeLabel === 'Lab') typeLabel = '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞';
            if(typeLabel === 'Lecture') typeLabel = '–õ–µ–∫—Ü—ñ—è';
            if(typeLabel === 'Practical') typeLabel = '–ü—Ä–∞–∫—Ç–∏—á–Ω–∞';

            // –õ–û–ì–Ü–ö–ê –î–õ–Ø –î–ò–°–¢–ê–ù–¶–Ü–ô–ù–û–ì–û –¢–ï–ì–£
            // –Ø–∫—â–æ –≤ –¥–∞–Ω–∏—Ö —î remote: true, –¥–æ–¥–∞—î–º–æ HTML —Ç–µ–≥
            const remoteTag = item.remote ? '<span class="tag remote">–î–∏—Å—Ç–∞–Ω—Ü—ñ–π–Ω–æ</span>' : '';

            return `
                <div class="lesson-card">
                    <div class="lesson-header-row">
                        <div class="lesson-number">${id}</div>
                        <div class="lesson-subject">${item.subject}</div>
                        <div class="lesson-time">${time}</div>
                    </div>
                    
                    <div class="tags">
                        <span class="tag ${typeClass}">${typeLabel}</span>
                        <span class="tag room">${item.room}</span>
                        ${remoteTag} <!-- –í—Å—Ç–∞–≤–∫–∞ —Ç–µ–≥—É —Ç—É—Ç -->
                    </div>

                    <div class="lesson-details">
                        <div class="detail-row">
                            <span class="detail-icon">üéì</span>
                            <span>${item.teacher}</span>
                        </div>
                    </div>
                </div>
            `;
        }

        init();
    </script>
</body>
</html>